server:
	module-config: "respip validator iterator"
	verbosity: 1

	num-threads: 4

	interface: ::0@53
	interface: ::0@853
	interface: 0.0.0.0@53
	interface: 0.0.0.0@853
	interface: 127.0.0.1

	port: 53

	prefer-ip6: no

	outgoing-range: 4096

	outgoing-num-tcp: 1000

	incoming-num-tcp: 1000

	so-rcvbuf: 4m

	so-sndbuf: 4m

	so-reuseport: yes

	edns-buffer-size: 4096

	max-udp-size: 4096

	stream-wait-size: 8m

	msg-cache-size: 8m

	msg-cache-slabs: 8

	num-queries-per-thread: 1024

	rrset-cache-size: 2G

	rrset-cache-slabs: 8

	cache-max-ttl: 900

	cache-max-negative-ttl: 60

	do-ip4: yes

	do-ip6: yes

	do-udp: yes

	do-tcp: yes

	udp-upstream-without-downstream: yes

	do-daemonize: no

	access-control: ::1 allow_snoop
	access-control: 0.0.0.0/0 refuse
	access-control: 127.0.0.0/8 allow_snoop
	access-control: 10.0.0.0/8 allow_snoop
	access-control: 172.16.0.0/12 allow_snoop
	access-control: 192.168.0.0/16 allow_snoop

	username: ""

	directory: "/etc/unbound"

	logfile: "/etc/unbound/log"

	use-syslog: no

	log-identity: "unbound"

	log-time-ascii: yes

	log-queries: no

	log-replies: no

	log-servfail: no

	pidfile: "/etc/unbound/unbound.pid"

	root-hints: "/etc/unbound/root.cache"

	hide-identity: no

	hide-version: yes

	hide-trustanchor: yes

	identity: ""

	version: ""

	harden-glue: yes

	qname-minimisation: yes

	qname-minimisation-strict: no


	prefetch: no


	deny-any: yes


	minimal-responses: no


	val-bogus-ttl: 60

	serve-expired: no



	#tls-service-key: "/etc/letsencrypt/live/<server-name>/privkey.pem"
	#tls-service-pem: "/etc/letsencrypt/live/<server-name>/fullchain.pem"
	#tls-port: 853

	# cipher setting for TLSv1.2
	#tls-ciphers: "DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256"
	# cipher setting for TLSv1.3
	#tls-ciphersuites: "TLS_AES_128_GCM_SHA256:TLS_AES_128_CCM_8_SHA256:TLS_AES_128_CCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256"

	# Add the secret file for TLS Session Ticket.
	# Secret file must be 80 bytes of random data.
	# First key use to encrypt and decrypt TLS session tickets.
	# Other keys use to decrypt only.
	# requires restart to take effect.
	#tls-session-ticket-keys: "/etc/unbound/secret1"
	#tls-session-ticket-keys: "/etc/unbound/secret2"

	tls-upstream: no

	#tls-cert-bundle: "/etc/ssl/certs/ca-certificates.crt"

python:

remote-control:
	control-enable: yes

	control-interface: 127.0.0.1

	control-port: 8953

	control-use-cert: "yes"

	server-key-file: "/etc/unbound/unbound_server.key"

	server-cert-file: "/etc/unbound/unbound_server.pem"

	control-key-file: "/etc/unbound/unbound_control.key"

	control-cert-file: "/etc/unbound/unbound_control.pem"

#rpz:
#	name: <zone-name>
#	zonefile: zonefiles/<zone-name>
#	master: <distribution-masters>
#	rpz-log: yes
#	rpz-log-name: <zone-name>

#------------------------------------------------------------------------------
# Deteque Abused Legit RPZ Zones
#       - botnetcc.hacked.host.dtq
#       - botnetcc.hacked.ip.dtq
#       - malware.hacked.host.dtq
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Deteque Botnet RPZ Zones
#       - botnetcc.edit.host.dtq
#       - botnetcc.hacked.host.dtq
#       - botnetcc.hacked.ip.dtq
#       - botnetcc.host.dtq
#       - botnetcc.ip.dtq
#       - botnet.edit.host.dtq
#       - botnet.host.dtq
#       - dga.host.dtq
#------------------------------------------------------------------------------
rpz:
	name: botnetcc.host.dtq
	zonefile: zonefiles/botnetcc.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: botnetcc.host.dtq
rpz:
	name: botnetcc.ip.dtq
	zonefile: zonefiles/botnetcc.ip.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: botnetcc.ip.dtq
rpz:
	name: botnet.host.dtq
	zonefile: zonefiles/botnet.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: botnet.host.dtq
rpz:
	name: dga.host.dtq
	zonefile: zonefiles/dga.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: dga.host.dtq
rpz:
	name: botnetcc.host.dtq
	zonefile: zonefiles/botnetcc.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: botnetcc.host.dtq

#------------------------------------------------------------------------------
# Deteque Malware RPZ Zones
#       - malware.domains.dtq
#       - malware.edit.host.dtq
#       - malware.hacked.host.dtq
#       - malware.host.dtq
#------------------------------------------------------------------------------

rpz:
	name: malware.domains.dtq
	zonefile: zonefiles/malware.domains.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: malware.domains.dtq
rpz:
	name: malware.hacked.host.dtq
	zonefile: zonefiles/malware.hacked.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: malware.hacked.host.dtq
rpz:
	name: malware.host.dtq
	zonefile: zonefiles/malware.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: malware.host.dtq

#------------------------------------------------------------------------------
# Deteque Bad Reputation RPZ Zones
#       - adware.edit.host.dtq
#       - adware.host.dtq
#       - bad-nameservers.host.dtq
#       - bad-nameservers.ip.dtq
#       - badrep.edit.host.dtq
#       - badrep.hacked.host.dtq
#       - badrep.host.dtq
#       - bogons.ip.dtq
#       - drop.ip.dtq
#------------------------------------------------------------------------------

rpz:
	name: adware.edit.host.dtq
	zonefile: zonefiles/adware.edit.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: adware.edit.host.dtq
rpz:
	name: bad-nameservers.ip.dtq
	zonefile: zonefiles/bad-nameservers.ip.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: bad-nameservers.ip.dtq
rpz:
	name: bad-nameservers.host.dtq
	zonefile: zonefiles/bad-nameservers.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: bad-nameservers.host.dtq
rpz:
	name: badrep.host.dtq
	zonefile: zonefiles/badrep.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: badrep.host.dtq
rpz:
	name: bogons.ip.dtq
	zonefile: zonefiles/bogons.ip.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: bogons.ip.dtq
rpz:
	name: drop.ip.dtq
	zonefile: zonefiles/drop.ip.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: drop.ip.dtq

#------------------------------------------------------------------------------
# Deteque Phishing RPZ Zones
#       - phish.edit.host.dtq
#       - phish.hacked.host.dtq
#       - phish.host.dtq
#------------------------------------------------------------------------------

rpz:
	name: phish.host.dtq
	zonefile: zonefiles/phish.host.dtq
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: phish.host.dtq

#------------------------------------------------------------------------------
# Deteque Third Party RPZ Zones
#       - coinblocker.srv
#       - porn.host.srv
#       - torblock.srv
#------------------------------------------------------------------------------

rpz:
	name: coinblocker.srv
	zonefile: zonefiles/coinblocker.srv
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: coinblocker.srv
rpz:
	name: torblock.srv
	zonefile: zonefiles/torblock.srv
	master: <distribution-masters>
	rpz-log: yes
	rpz-log-name: torblock.srv
